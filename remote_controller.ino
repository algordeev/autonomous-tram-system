#include <SPI.h>
#include <nRF24L01.h>
#include <RF24.h>

#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>
/*------------------------------------------------*/
#define OLED_RESET 5
Adafruit_SSD1306 display(OLED_RESET);
  
#define JOYSTICK_Y A7
const unsigned char PROGMEM logoBmp[] = {
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x7F, 0xFF, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x80, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x02, 0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x0C, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x10, 0x02, 0x08, 0x40, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x40, 0x00, 0x00, 0x00, 0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x01, 0x80, 0x00, 0x00, 0x00, 0x1C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x06, 0x00, 0x00, 0x00, 0x00, 0x01, 0x01, 0xFE, 0x03, 0xFC, 0x1F, 0xFC, 0xE0, 0x61, 0xC0, 0xC0,
0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x69, 0xFF, 0x83, 0xFF, 0x1F, 0xFC, 0xF0, 0x61, 0xE0, 0xC0,
0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0xC3, 0xC3, 0x87, 0x81, 0xC0, 0xF0, 0x61, 0xE0, 0xC0,
0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0xC1, 0xC3, 0x83, 0x81, 0xC0, 0xD8, 0x61, 0xB0, 0xC0,
0x80, 0x03, 0xF0, 0xA8, 0x7E, 0x00, 0x09, 0xC0, 0xE3, 0x81, 0xC1, 0xC0, 0xD8, 0x61, 0xB0, 0xC0,
0x80, 0x02, 0x10, 0xA8, 0x42, 0x00, 0x09, 0xC0, 0xE3, 0x81, 0xC1, 0xC0, 0xCC, 0x61, 0x98, 0xC0,
0x96, 0x82, 0x10, 0xA8, 0x42, 0x0B, 0x49, 0xC0, 0xE3, 0x81, 0xC1, 0xC0, 0xCC, 0x61, 0x98, 0xC0,
0x96, 0x82, 0x10, 0xA8, 0x42, 0x0B, 0x49, 0xC0, 0xE3, 0x81, 0xC1, 0xC0, 0xC6, 0x61, 0x8C, 0xC0,
0x96, 0x82, 0x10, 0xA8, 0x42, 0x0B, 0x49, 0xC0, 0xE3, 0x81, 0xC1, 0xC0, 0xC6, 0x61, 0x8C, 0xC0,
0x96, 0x83, 0xF0, 0xF8, 0x7E, 0x0B, 0x49, 0xC0, 0xE3, 0x81, 0xC1, 0xC0, 0xC6, 0x61, 0x8C, 0xC0,
0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0xC0, 0xE3, 0x81, 0xC1, 0xC0, 0xC3, 0x61, 0x86, 0xC0,
0x80, 0x03, 0xE0, 0x00, 0x3E, 0x00, 0x09, 0xC1, 0xC3, 0x83, 0x81, 0xC0, 0xC3, 0x61, 0x86, 0xC0,
0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0xC3, 0xC3, 0x87, 0x81, 0xC0, 0xC1, 0xE1, 0x83, 0xC0,
0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0xFF, 0x83, 0xFF, 0x01, 0xC0, 0xC1, 0xE1, 0x83, 0xC0,
0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x09, 0xFC, 0x03, 0xF8, 0x01, 0xC0, 0xC0, 0xE1, 0x81, 0xC0,
0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x9F, 0x83, 0xF0, 0x20, 0x7E, 0x0F, 0xC8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x9F, 0x83, 0xF0, 0x70, 0x7E, 0x0F, 0xC8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x9F, 0x83, 0xF0, 0x00, 0x7E, 0x0F, 0xC8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x9F, 0x83, 0xF0, 0x00, 0x7E, 0x0F, 0xC8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x80, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xF8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xF0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};

const uint64_t pipe = 0xE8E8F0F0E1LL;
RF24 radio(7, 8);
int joystick[4];
void setup()

{
 display.begin(SSD1306_SWITCHCAPVCC, 0x3C);  // инициализация дисплея по интерфейсу I2C, адрес 0x3C
  display.clearDisplay(); // очистка дисплея
  radio.begin();
  radio.openWritingPipe(pipe);
  pinMode(2, INPUT);
  pinMode(4, INPUT);
  pinMode(A7, INPUT);
  digitalWrite(2, HIGH);
  digitalWrite(4, HIGH);
    digitalWrite(6, HIGH);
  display.drawBitmap(0, 0, logoBmp, 128, 64, WHITE); // рисуем нашу картинку на экране
  display.display(); // выводим её на OLED
}


void loop()
{
    
  
   
     
if(digitalRead(3))
{
  joystick[0] = analogRead(JOYSTICK_Y);//motor
}
else
{
  joystick[0] = analogRead(A6);//motor
}
                  
  
                  //joystick[2] = analogRead(JOYSTICK_Z);
                  //joystick[2] = map(joystick[2],0,1023,1,180);
  joystick[1] = !digitalRead(2);//knopka
 joystick[2] = !digitalRead(4);//knopka stop
 joystick[3] = digitalRead(6);//revers
  radio.write( joystick, sizeof(joystick) );
   
    
}
